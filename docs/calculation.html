<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>calculation &mdash; QhX 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="detection" href="detection.html" />
    <link rel="prev" title="light_curve" href="light_curve.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="index.html" class="icon icon-home">
            QhX
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="package.html">Package Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data_manager.html">data_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="light_curve.html">light_curve</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#QhX.calculation.get_full_width"><code class="docutils literal notranslate"><span class="pre">get_full_width()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.calculation.periods"><code class="docutils literal notranslate"><span class="pre">periods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.calculation.signif_johnson"><code class="docutils literal notranslate"><span class="pre">signif_johnson()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="detection.html">detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="wwtz.html">wwtz</a></li>
<li class="toctree-l2"><a class="reference internal" href="superlet.html">superlet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="superlets.html">superlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation.html">correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg.html">reg</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive_plt.html">interactive_plt</a></li>
<li class="toctree-l2"><a class="reference internal" href="iparallelization_solver.html">iparallelization_solver module</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization_solver.html">Parallelization Solver module</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch_processor.html">Batch Processor Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="merge_batch_csv.html">merge_batch_csv Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel_classification.html">Parallel Classification Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_parallel.html">output_parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive_plot_large_files.html">Interactive Plot Large Files Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing_utils.html">processing_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_integrated.html">test_integrated</a></li>
<li class="toctree-l2"><a class="reference internal" href="mock_lc.html">mock_lc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QhX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="package.html">Package Modules</a></li>
      <li class="breadcrumb-item active">calculation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/calculation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-QhX.calculation">
<span id="calculation"></span><h1>calculation<a class="headerlink" href="#module-QhX.calculation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="QhX.calculation.get_full_width">
<span class="sig-prename descclassname"><span class="pre">QhX.calculation.</span></span><span class="sig-name descname"><span class="pre">get_full_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/QhX/calculation.html#get_full_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.calculation.get_full_width" title="Link to this definition"></a></dt>
<dd><p>Calculate the error of the determined period using the FWHM method and determine quantiles.
This function calculates the error of the determined period using the Full Width at Half Maximum (FWHM) method.
It is part of a post-mortem analysis to estimate the period uncertainty based on the Mean Noise Power Level (MNPL) in the vicinity of the peak.
The function detects the FWHM of a peak and then calculates the points between the 25th and 75th quantile to find MNPL.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>x (np.ndarray): An array containing the x-axis values (e.g., time).</p></li>
<li><p>y (np.ndarray): An array containing the corresponding y-axis values (e.g., intensity).</p></li>
<li><p>peak (np.ndarray): An array containing the indices of determined peaks.</p></li>
<li><p>height (float, optional): The fraction of the peak’s maximum height to define the FWHM. Default is 0.5.</p></li>
</ul>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<p>tuple: A tuple containing six arrays of results:</p>
<ul class="simple">
<li><p>er1: An array of lower x-values for quantiles.</p></li>
<li><p>er3: An array of upper x-values for quantiles.</p></li>
<li><p>quantiles: An array of quantiles (25th and 75th percentile) calculated from peak data.</p></li>
<li><p>phmax: An array of half the peak’s maximum height.</p></li>
<li><p>x_lows: An array of lower x-values corresponding to the FWHM.</p></li>
<li><p>x_highs: An array of upper x-values corresponding to the FWHM.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.calculation.periods">
<span class="sig-prename descclassname"><span class="pre">QhX.calculation.</span></span><span class="sig-name descname"><span class="pre">periods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lcID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peakHeight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minfq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/calculation.html#periods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.calculation.periods" title="Link to this definition"></a></dt>
<dd><p>Perform period determination for the output of hybrid2d data.
This function analyzes auto-correlation data to determine periods of a light curve.</p>
<section id="id1">
<h2>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>lcID (int): ID of the light curve.</p></li>
<li><p>data (numpy.ndarray): Auto-correlation matrix.</p></li>
<li><p>ngrid (int): Number of values for controlling WWZ execution (see inp_param function).</p></li>
<li><p>plot (bool): True if a plot is desired, False otherwise.</p></li>
<li><p>save (bool): True to save the plot, False otherwise.</p></li>
<li><p>peakHeight (float): Maximum peak height for peak detection.</p></li>
<li><p>prominence (float): Prominence threshold for peak determination.</p></li>
<li><p>minfq (float, optional): Minimum frequency for analysis. Default is None.</p></li>
<li><p>maxfq (float, optional): Maximum frequency for analysis. Default is None.</p></li>
<li><p>xlim (tuple, optional): Set the x-axis limits for the plot. Default is None.</p></li>
</ul>
</section>
<section id="id2">
<h2>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>A tuple containing:</p>
<ul class="simple">
<li><p>idx_peaks (list): Indices of detected peaks.</p></li>
<li><p>yax (numpy.ndarray): Processed data.</p></li>
<li><p>r_peaks (list): Detected periods.</p></li>
<li><p>r_peaks_err_upper (list): Upper errors of corresponding periods.</p></li>
<li><p>r_peaks_err_lower (list): Lower errors of corresponding periods.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.calculation.signif_johnson">
<span class="sig-prename descclassname"><span class="pre">QhX.calculation.</span></span><span class="sig-name descname"><span class="pre">signif_johnson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numlc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peakHeight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minfq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wwz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mag_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/calculation.html#signif_johnson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.calculation.signif_johnson" title="Link to this definition"></a></dt>
<dd><p>Assess the significance of detected peaks in light curve data using the Johnson method,
with an option to incorporate magnitude errors into the analysis.
This function performs a significance test on the peaks detected in a light curve. It
compares the peak power against the power of red noise (background noise) to determine
the likelihood that the peak is a true signal rather than noise. The analysis can be
enhanced by incorporating magnitude errors, which adds robustness to the significance
estimation.</p>
<section id="id3">
<h2>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>numlc (int): Number of light curves to analyze.</p></li>
<li><p>peak (int): Index of the peak for which significance is being calculated.</p></li>
<li><p>idx_peaks (np.ndarray): Array of indices of detected peaks.</p></li>
<li><p>yax (np.ndarray): Array of processed data corresponding to the peaks.</p></li>
<li><p>tt (np.ndarray): Array of time stamps for the light curve.</p></li>
<li><p>yy (np.ndarray): Array of magnitude values of the light curve.</p></li>
<li><p>ntau (int): Number of time divisions for the analysis.</p></li>
<li><p>ngrid (int): Grid size for frequency analysis.</p></li>
<li><p>f (float, optional): Frequency parameter for the analysis algorithm. Default is 2.</p></li>
<li><p>peakHeight (float, optional): Threshold for peak height. Default is 0.6.</p></li>
<li><p>minfq (float, optional): Minimum frequency for analysis. Default is 1500.</p></li>
<li><p>maxfq (float, optional): Maximum frequency for analysis. Default is 10.</p></li>
<li><p>algorithm (str, optional): Name of the analysis algorithm to use. Default is ‘wwz’.</p></li>
<li><p>method (str, optional): Interpolation method for the analysis. Default is ‘linear’.</p></li>
<li><p>use_mag_errors (bool, optional): Flag to indicate whether to use magnitude errors. Default is False.</p></li>
<li><p>err_mag (np.ndarray, optional): Array of magnitude errors. Required if use_mag_errors is True.</p></li>
</ul>
</section>
<section id="id4">
<h2>Returns:<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<p>tuple: A tuple containing the following elements:</p>
<ul class="simple">
<li><p>bins (list): List of peak power values.</p></li>
<li><p>bins11 (list): List of red noise power values at the peak positions.</p></li>
<li><p>count / numlc (float): Fraction of cases where peak power is larger than red noise power.</p></li>
<li><p>count11 / numlc (float): Fraction of cases where red noise power is larger than peak power.</p></li>
</ul>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="light_curve.html" class="btn btn-neutral float-left" title="light_curve" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="detection.html" class="btn btn-neutral float-right" title="detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andjelka Kovacevic.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>