<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QhX.utils.mock_lc &mdash; QhX_dynamical 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=01f34227"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            QhX_dynamical
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../important_note.html">Important Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start.html">Quick Start Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../test_integrated.html">test_integrated</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#theoretical-background">Theoretical background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#qhx-project-history">QhX Project History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html#qhx-package-overview">QhX Package Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../package.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support_and_contact.html">Support and Contact Information</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">QhX_dynamical</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">QhX.utils.mock_lc</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for QhX.utils.mock_lc</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">colorednoise</span> <span class="k">as</span> <span class="nn">cn</span>


<div class="viewcode-block" id="artificial_lc_sampled">
<a class="viewcode-back" href="../../../mock_lc.html#QhX.utils.mock_lc.artificial_lc_sampled">[docs]</a>
<span class="k">def</span> <span class="nf">artificial_lc_sampled</span><span class="p">(</span><span class="n">mjd</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Returns a hypothetical light curve sampled in a given OpSim strategy.</span>
<span class="sd">    User needs to provide a reference light curve for sampling (usually a continous</span>
<span class="sd">    light curve with 1 day cadence, see LC_conti() function).</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    mjd: np.array</span>
<span class="sd">        Modified Julian Date obtained from OpSim. It is the time of each sampling of the light curve</span>
<span class="sd">        during the LSST operation period in one of the filters and specified sky coordinates.</span>
<span class="sd">    t: np.array</span>
<span class="sd">        Days during the survey on which we had an observation for a continuous reference light curve.</span>
<span class="sd">    y: np.array</span>
<span class="sd">        Light curve magnitudes for continuous reference light curve.</span>
<span class="sd">     </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    top: np.array</span>
<span class="sd">        Days during the survey when we had an observation (sampling) in a given OpSim strategy.</span>
<span class="sd">    yop: np.array</span>
<span class="sd">        Light curve magnitude taken from the reference light curve on days we had an observation </span>
<span class="sd">        (sampling) in a given OpSim strategy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Convert MJD to survey days</span>
    <span class="n">top</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">mjd</span><span class="o">-</span><span class="n">mjd</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    
    <span class="c1"># Reference light curve sampling</span>
    <span class="n">yop</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="p">)):</span>
        <span class="n">abs_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">top</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="c1"># Find matching days and their index</span>
        <span class="n">bool_arr</span> <span class="o">=</span> <span class="n">abs_vals</span> <span class="o">&lt;</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">bool_arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bool_arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            
        <span class="c1"># Case when we don&#39;t have a match</span>
        <span class="k">elif</span> <span class="n">bool_arr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">yop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span>
    <span class="n">yop</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">yop</span><span class="p">)</span>
    
    <span class="c1"># Drop placeholder values (-999)</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">mjd</span> <span class="o">-</span> <span class="n">mjd</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">top</span><span class="p">[</span><span class="n">yop</span><span class="o">!=-</span><span class="mi">999</span><span class="p">]</span>
    <span class="n">yop</span> <span class="o">=</span> <span class="n">yop</span><span class="p">[</span><span class="n">yop</span><span class="o">!=-</span><span class="mi">999</span><span class="p">]</span>
    
    
    
    
    <span class="k">return</span> <span class="n">top</span><span class="p">,</span><span class="n">yop</span></div>


<div class="viewcode-block" id="artificial_stochastic_mock_lc">
<a class="viewcode-back" href="../../../mock_lc.html#QhX.utils.mock_lc.artificial_stochastic_mock_lc">[docs]</a>
<span class="k">def</span> <span class="nf">artificial_stochastic_mock_lc</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">deltatc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">oscillations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.00005</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Generate one artificial light curve using a stochastic model based on the Damped random walk (DRW)</span>
<span class="sd">    proccess. Parameters describing the model are characteristic amplitude (&quot;logsig2&quot; in code) and time </span>
<span class="sd">    scale of the exponentially-decaying variability (&quot;tau&quot; in code), both infered from physical </span>
<span class="sd">    quantities such are supermassive black hole mass and/or luminosity of the AGN. For further details</span>
<span class="sd">    regarding the model see Kovačević et al. (2021) and references therein.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    T: int</span>
<span class="sd">        Total time span of the light curve. It is recommended to generate light curves to be at least </span>
<span class="sd">        10 times longer than their characteristic timescale (Kozłowski 2017). </span>
<span class="sd">    deltatc: int, default=1</span>
<span class="sd">        Cadence (or sampling rate) - time interval between two consecutive samplings of the light </span>
<span class="sd">        curve in days.</span>
<span class="sd">    oscillations: bool, default=True</span>
<span class="sd">        If True, light curve simulation will take an oscillatory signal into account.</span>
<span class="sd">    A: float, default=0.14</span>
<span class="sd">        Amplitude of the oscillatory signal in magnitudes (used only if oscillations=True).</span>
<span class="sd">    noise: float, default=0.00005</span>
<span class="sd">        Amount of noise to include in the light curve simulation.</span>
<span class="sd">    z: float, default=0</span>
<span class="sd">        Redshift.</span>
<span class="sd">    frame: {&#39;observed&#39;, &#39;rest&#39;}, default=&#39;observed&#39;</span>
<span class="sd">        Frame of reference.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    tt: np.array</span>
<span class="sd">        Days when the light curve was sampled.</span>
<span class="sd">    yy: np.array</span>
<span class="sd">        Magnitudes of the simulated light curve.</span>
<span class="sd">        </span>
<span class="sd">    References:</span>
<span class="sd">    -----------</span>

<span class="sd">    - `Ivezić, Ž., et al. 2019, ApJ, 873, 111 &lt;https://iopscience.iop.org/article/10.3847/1538-4357/ab042c&gt;`_.</span>
<span class="sd">    - `Kelly, B.C., Bechtold, J., &amp; Siemiginowska, A. 2009, ApJ, 698, 895 &lt;https://iopscience.iop.org/article/10.1088/0004-637X/698/1/895&gt;`_.</span>
<span class="sd">    - `Kozłowski, S. 2017, A&amp;A, 597, A128 &lt;https://www.aanda.org/articles/aa/full_html/2017/01/aa29890-16/aa29890-16.html&gt;`_.</span>
<span class="sd">    - `Kovacevic A. B., Ilic D., Popovic L. C., Radovic V., Jankov I., Yoon I., Caplar N., et al., 2021, MNRAS, 505, 5012</span>
<span class="sd">      &lt;https://ui.adsabs.harvard.edu/abs/2021MNRAS.505.5012K/abstract&gt;`_.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Constants</span>
    <span class="n">const1</span> <span class="o">=</span> <span class="mf">0.455</span><span class="o">*</span><span class="mf">1.25</span><span class="o">*</span><span class="mf">1e38</span>
    <span class="n">const2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1e09</span><span class="p">)</span>
    <span class="n">meanmag</span> <span class="o">=</span> <span class="mf">23.</span>
    
    <span class="c1"># Generating survey days </span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">deltatc</span><span class="p">))</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Generating log L_bol</span>
    <span class="n">loglumbol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">42.2</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lumbol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">loglumbol</span><span class="p">)</span>

    <span class="c1"># Calculate M_{SMBH}</span>
    <span class="n">msmbh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="n">lumbol</span> <span class="o">*</span> <span class="n">const2</span> <span class="o">/</span> <span class="n">const1</span><span class="p">),</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>
    
    <span class="c1"># Calculate damping time scale (Eq 22, Kelly et al. 2009)</span>
    <span class="n">logtau</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.13</span> <span class="o">+</span> <span class="mf">0.24</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lumbol</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.34</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="s1">&#39;observed&#39;</span><span class="p">:</span>
        <span class="c1"># Converting to observed frame (Eq 17, Kelly et al. 2009)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">logtau</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frame</span> <span class="o">==</span> <span class="s1">&#39;rest&#39;</span><span class="p">:</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">logtau</span><span class="p">)</span>
    
    <span class="c1"># Calculate log sigma^2 - an amplitude of correlation decay (Eq 25, Kelly et al. 2009)</span>
    <span class="n">logsig2</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="mf">0.27</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lumbol</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.47</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="s1">&#39;observed&#39;</span><span class="p">:</span>
        <span class="c1"># Converting to observed frame (Eq 18, Kelly et al. 2009)</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">logsig2</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">frame</span> <span class="o">==</span> <span class="s1">&#39;rest&#39;</span><span class="p">:</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">logsig2</span><span class="p">))</span>
          
    <span class="c1"># OPTIONAL: Calculate the broad line region radius</span>
    <span class="n">logrblr</span> <span class="o">=</span> <span class="mf">1.527</span> <span class="o">+</span> <span class="mf">0.533</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lumbol</span> <span class="o">/</span> <span class="mf">1e44</span><span class="p">)</span>
    <span class="n">rblr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">logrblr</span><span class="p">)</span>
    <span class="n">rblr</span> <span class="o">=</span> <span class="n">rblr</span> <span class="o">/</span> <span class="mi">10</span>
    
    <span class="c1"># Calculating light curve magnitudes</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
    <span class="n">ss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">meanmag</span> <span class="c1"># light curve is initialized</span>
    <span class="n">SFCONST2</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">*</span> <span class="n">sig</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="o">-</span><span class="n">deltatc</span> <span class="o">/</span> <span class="n">tau</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
        <span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span> <span class="o">+</span> <span class="n">meanmag</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ratio</span><span class="p">)),</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">SFCONST2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">))),</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="c1"># Calculating error (Ivezic et al. 2019)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.039</span>
    <span class="n">m5</span> <span class="o">=</span> <span class="mf">24.7</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="n">ss</span> <span class="o">-</span> <span class="n">m5</span><span class="p">))</span>

    <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.005</span> <span class="o">*</span> <span class="mf">0.005</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.04</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
    
    <span class="c1"># Setting period type and value (modify these lines as needed)</span>
    <span class="n">period_type</span> <span class="o">=</span> <span class="s1">&#39;hardcoded&#39;</span>  <span class="c1"># &#39;hardcoded&#39; or &#39;physical&#39;</span>
    <span class="n">P_value</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># Only used if period_type is &#39;hardcoded&#39;, it should be in years</span>

    <span class="c1"># Final light curve with oscillations</span>
    <span class="k">if</span> <span class="n">oscillations</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">period_type</span> <span class="o">==</span> <span class="s1">&#39;physical&#39;</span><span class="p">:</span>
            <span class="c1"># Calculate underlying periodicity</span>
            <span class="n">conver</span> <span class="o">=</span> <span class="mf">173.145</span> <span class="c1"># convert from LightDays to AU</span>
            <span class="n">lightdays</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">P_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">lightdays</span> <span class="o">*</span> <span class="n">conver</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="n">msmbh</span><span class="p">)</span>
            <span class="n">P_days</span> <span class="o">=</span> <span class="n">P_years</span> <span class="o">*</span> <span class="mf">365.25</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">P_days</span> <span class="o">=</span> <span class="n">P_value</span> <span class="o">*</span> <span class="mf">365.25</span>
        
        <span class="c1"># Calculating and adding oscillatory signal</span>
        <span class="n">sinus</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tt</span> <span class="o">/</span> <span class="n">P_days</span><span class="p">)</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="n">ss</span> <span class="o">+</span> <span class="n">sinus</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="c1"># Adding error and noise to each magnitude value</span>
            <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="n">noise</span> <span class="o">*</span> <span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
        <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">P_days</span>
    
    <span class="c1"># Final light curve without oscillations</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">oscillations</span><span class="p">:</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="c1"># Adding error and noise to each magnitude value</span>
            <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="n">noise</span> <span class="o">*</span> <span class="n">ss</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
        <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">yy</span></div>

    
<div class="viewcode-block" id="remove_fraction_with_seed">
<a class="viewcode-back" href="../../../mock_lc.html#QhX.utils.mock_lc.remove_fraction_with_seed">[docs]</a>
<span class="k">def</span> <span class="nf">remove_fraction_with_seed</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    removes a fraction of data at random with given seed.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    - data: data to remove</span>
<span class="sd">    - fraction: fraction to remove</span>
<span class="sd">    - seed: seed for randomness</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    </span>
<span class="sd">     data with fraction removed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_to_remove</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="n">n_to_remove</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></div>


<div class="viewcode-block" id="simple_mock_lc">
<a class="viewcode-back" href="../../../mock_lc.html#QhX.utils.mock_lc.simple_mock_lc">[docs]</a>
<span class="k">def</span> <span class="nf">simple_mock_lc</span><span class="p">(</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">percent</span><span class="p">,</span> <span class="n">magnitude</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span> <span class="n">mjd_start</span> <span class="o">=</span> <span class="mi">52000</span><span class="p">):</span>
    
    <span class="n">beta</span> <span class="o">=</span> <span class="n">exp</span> <span class="c1"># the exponent</span>
    
    <span class="n">x</span><span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">powerlaw_psd_gaussian</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span>
        <span class="n">time_interval</span> <span class="o">=</span> <span class="n">time_interval</span> <span class="o">*</span> <span class="mi">365</span>
    <span class="k">elif</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span>
        <span class="n">time_interval</span> <span class="o">=</span> <span class="n">time_interval</span>
    <span class="k">elif</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;hour&#39;</span><span class="p">:</span>
        <span class="n">time_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_interval</span><span class="o">/</span><span class="mf">24.0</span><span class="p">)</span><span class="o">*</span><span class="mi">365</span>
    <span class="k">elif</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;minute&#39;</span><span class="p">:</span>
        <span class="n">time_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_interval</span><span class="o">/</span><span class="p">(</span><span class="mf">24.0</span><span class="o">*</span><span class="mi">60</span><span class="p">))</span><span class="o">*</span><span class="mi">365</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_interval</span><span class="o">/</span><span class="p">(</span><span class="mf">24.0</span><span class="o">*</span><span class="mi">3600</span><span class="p">))</span><span class="o">*</span><span class="mi">365</span>
        
    <span class="n">t</span> <span class="o">=</span> <span class="n">mjd_start</span> <span class="o">+</span> <span class="n">time_interval</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>
    
    <span class="n">t1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">x_std</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="c1"># TODO: biranje za nivo X</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">+</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_std</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t1</span> <span class="o">/</span> <span class="n">frequency</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_std</span>
    
    <span class="n">tt</span><span class="o">=</span><span class="n">t1</span><span class="o">-</span><span class="n">t1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    
    <span class="n">tt</span> <span class="o">=</span> <span class="n">remove_fraction_with_seed</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">percent</span><span class="p">)</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">remove_fraction_with_seed</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">percent</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">mag</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andjelka Kovacevic.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>