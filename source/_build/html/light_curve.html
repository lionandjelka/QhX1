<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>light_curve &mdash; QhX 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="calculation" href="calculation.html" />
    <link rel="prev" title="data_manager" href="data_manager.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="index.html" class="icon icon-home">
            QhX
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="package.html">Package Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data_manager.html">data_manager</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">light_curve</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.generate_tiktok_signal"><code class="docutils literal notranslate"><span class="pre">generate_tiktok_signal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.get_lc22"><code class="docutils literal notranslate"><span class="pre">get_lc22()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.get_lctiktok"><code class="docutils literal notranslate"><span class="pre">get_lctiktok()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.inject_tiktok_to_light_curve"><code class="docutils literal notranslate"><span class="pre">inject_tiktok_to_light_curve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.outliers"><code class="docutils literal notranslate"><span class="pre">outliers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#QhX.light_curve.outliers_mad"><code class="docutils literal notranslate"><span class="pre">outliers_mad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="calculation.html">calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="detection.html">detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="wwtz.html">wwtz</a></li>
<li class="toctree-l2"><a class="reference internal" href="superlet.html">superlet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="superlets.html">superlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation.html">correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg.html">reg</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive_plt.html">interactive_plt</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_integrated.html">test_integrated</a></li>
<li class="toctree-l2"><a class="reference internal" href="mock_lc.html">mock_lc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QhX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="package.html">Package Modules</a></li>
      <li class="breadcrumb-item active">light_curve</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/light_curve.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-QhX.light_curve">
<span id="light-curve"></span><h1>light_curve<a class="headerlink" href="#module-QhX.light_curve" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.generate_tiktok_signal">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">generate_tiktok_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_instances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_frequency</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#generate_tiktok_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.generate_tiktok_signal" title="Link to this definition"></a></dt>
<dd><p>Generates a ‘tik-tok’ signal based on the given parameters.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>time_instances (array): Array of time instances for the signal generation.</p></li>
<li><p>initial_period (float): Initial period of the signal.</p></li>
<li><p>damping_factor_amplitude (float): Damping factor for the amplitude.</p></li>
<li><p>damping_factor_frequency (float): Damping factor for the frequency.</p></li>
</ul>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<p>array: Generated tik-tok signal values corresponding to the time instances.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.get_lc22">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">get_lc22</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#get_lc22"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.get_lc22" title="Link to this definition"></a></dt>
<dd><p>Process and return light curves with an option to include magnitude errors for a given set ID.</p>
<section id="id1">
<h2>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>set1 (str): The object ID for which light curves are to be processed.</p></li>
<li><p>include_errors (bool, optional): Flag to include magnitude errors in the time series. Defaults to True.</p></li>
</ul>
</section>
<section id="id2">
<h2>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>tuple: Contains the processed time series with or without magnitude errors for each</dt><dd><p>filter, along with their respective sampling rates. Returns None if the set ID
is not found or if any filter data is missing.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.get_lctiktok">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">get_lctiktok</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#get_lctiktok"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.get_lctiktok" title="Link to this definition"></a></dt>
<dd><p>Processes light curve data and optionally injects a tik-tok signal based on specified parameters.</p>
<section id="id3">
<h2>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>set1: Identifier for the dataset to process.</p></li>
<li><p>initial_period (float): Initial period of the tik-tok signal.</p></li>
<li><p>damping_factor_amplitude (float): Damping factor affecting the amplitude of the tik-tok signal.</p></li>
<li><p>damping_factor_frequency (float): Damping factor affecting the frequency of the tik-tok signal.</p></li>
<li><p>snr (float, optional): Signal-to-noise ratio for the tik-tok signal.</p></li>
<li><p>inject_signal (bool): Flag to determine whether to inject the tik-tok signal into the light curve.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id4">
<h2>Returns:<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<p>tuple: Processed time and magnitude data for multiple filters, their sampling rates, and tik-tok signals if injected.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.inject_tiktok_to_light_curve">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">inject_tiktok_to_light_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_light_curve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#inject_tiktok_to_light_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.inject_tiktok_to_light_curve" title="Link to this definition"></a></dt>
<dd><p>Injects a tik-tok signal into a real light curve.</p>
<section id="id5">
<h2>Parameters:<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>real_times (array): Array of time instances for the light curve.</p></li>
<li><p>real_light_curve (array): Original light curve data.</p></li>
<li><p>initial_period (float): Initial period of the tik-tok signal.</p></li>
<li><p>damping_factor_amplitude (float): Damping factor for the amplitude of the tik-tok signal.</p></li>
<li><p>damping_factor_frequency (float): Damping factor for the frequency of the tik-tok signal.</p></li>
<li><p>snr (float, optional): Signal-to-noise ratio for scaling the tik-tok signal.</p></li>
<li><p>inject_signal (bool): Flag to decide whether to inject the tik-tok signal or not.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id6">
<h2>Returns:<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<p>tuple: Modified light curve with tik-tok signal injected and the interpolated tik-tok signal.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.outliers">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.outliers" title="Link to this definition"></a></dt>
<dd><p>Identifies and removes outliers from a light curve based on a Z-score threshold.
This function applies a Z-score method to identify and remove outliers from light curve data.
If flux error values are provided, the function considers these for a more nuanced outlier detection.</p>
<section id="id7">
<h2>Parameters:<a class="headerlink" href="#id7" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>time (array): Array of time values.</p></li>
<li><p>flux (array): Array of flux values corresponding to the time values.</p></li>
<li><p>err_flux (array, optional): Array of flux error values. If provided, the function
considers error-weighted Z-scores for outlier detection.</p></li>
</ul>
</section>
<section id="id8">
<h2>Returns:<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<p>tuple: A tuple consisting of arrays of time and flux values with outliers removed.
If ‘err_flux’ is provided, returns a third array of flux error values with
outliers removed.</p>
</section>
<section id="example">
<h2>Example:<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<p>Assuming <cite>time</cite>, <cite>flux</cite>, and <cite>err_flux</cite> are arrays with light curve data:
&gt;&gt;&gt; clean_time, clean_flux = outliers(time, flux)
&gt;&gt;&gt; clean_time, clean_flux, clean_err_flux = outliers(time, flux, err_flux)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="QhX.light_curve.outliers_mad">
<span class="sig-prename descclassname"><span class="pre">QhX.light_curve.</span></span><span class="sig-name descname"><span class="pre">outliers_mad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/QhX/light_curve.html#outliers_mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#QhX.light_curve.outliers_mad" title="Link to this definition"></a></dt>
<dd><p>Identifies and removes outliers from a light curve data set using Median Absolute Deviation (MAD).
This function applies the MAD method to identify and remove outliers in light curve data. It can optionally
consider errors in flux measurements for a more nuanced outlier detection. The outlier detection threshold
is determined as a multiple of the MAD, with an optional inclusion of median error for adjustment.</p>
<section id="id9">
<h2>Parameters:<a class="headerlink" href="#id9" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>time (array): Array of time values corresponding to light curve measurements.</p></li>
<li><p>flux (array): Array of flux values corresponding to the light curve.</p></li>
<li><p>err_flux (array, optional): Array of errors associated with flux measurements.
If provided, these values adjust the outlier detection threshold.</p></li>
<li><p>threshold_factor (float, optional): A multiplier used with MAD to set the threshold
for outlier detection. Default is 3.0. Smaller values imply stricter outlier removal.</p></li>
</ul>
</section>
<section id="id10">
<h2>Returns:<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>clean_time (array): Array of time values with outliers removed.</p></li>
<li><p>clean_flux (array): Array of flux values with outliers removed.</p></li>
<li><p>clean_err_flux (array, optional): Array of error flux values with outliers removed,
returned only if <cite>err_flux</cite> is provided.</p></li>
</ul>
</section>
<section id="id11">
<h2>Example:<a class="headerlink" href="#id11" title="Link to this heading"></a></h2>
<p>Assuming <cite>time</cite>, <cite>flux</cite>, and <cite>err_flux</cite> are arrays with light curve data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clean_time</span><span class="p">,</span> <span class="n">clean_flux</span> <span class="o">=</span> <span class="n">outliers_mad</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">flux</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clean_time</span><span class="p">,</span> <span class="n">clean_flux</span><span class="p">,</span> <span class="n">clean_err_flux</span> <span class="o">=</span> <span class="n">outliers_mad</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">err_flux</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data_manager.html" class="btn btn-neutral float-left" title="data_manager" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="calculation.html" class="btn btn-neutral float-right" title="calculation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andjelka Kovacevic.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>